(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/monthlyCard/pay"],{3111:function(e,t,n){"use strict";(function(e){var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n("2eee")),c=a(n("c973")),i=n("6d37"),o={data:function(){return{id:"",licensePlate:"",carParkInfo:{carParkName:"",currentPrice:"",title:""},num:1}},onLoad:function(e){this.id=e.id,this.licensePlate=e.licensePlate,this.fenchData()},methods:{onPay:function(){var t=this;return(0,c.default)(r.default.mark((function n(){var a,c,o,u,s,f;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,i.buyCarParkPackageProduct)({numberPlate:t.licensePlate,packageProductId:t.carParkInfo.id,platform:"wx_mp",quantity:t.num});case 2:a=n.sent,c=a.data,o=a.code,u=a.message,10002==o?null==c?e.showToast({title:u,icon:"none"}):(s=t.carParkInfo.currentPrice*t.num,f=t.carParkInfo.carParkName,e.requestPayment({provider:"wxpay",timeStamp:c.timeStamp,nonceStr:c.nonceStr,package:c.package,signType:c.signType,paySign:c.paySign,success:function(t){"requestPayment:ok"==t.errMsg&&e.reLaunch({url:"/pages/pay/paymentComplete?price="+s+"&parkName="+f})},fail:function(t){e.showToast({title:t,icon:"none"})}})):e.showToast({title:u,icon:"none"});case 7:case"end":return n.stop()}}),n)})))()},onAliPay:function(){var t=this;return(0,c.default)(r.default.mark((function n(){var a,c,o,u;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,i.buyCarParkPackageProduct)({numberPlate:t.licensePlate,packageProductId:t.carParkInfo.id,platform:"ali_mp",quantity:t.num});case 2:a=n.sent,c=a.data,o=a.code,u=a.message,10002==o?e.requestPayment({provider:"alipay",orderInfo:c.alipay_trade_create_response.trade_no,success:function(t){"9000"==t.resultCode?(e.showToast({title:"支付成功",icon:"none"}),setTimeout((function(){e.switchTab({url:"/pages/my/my"})}),1500)):e.showToast({title:t.memo,icon:"none"})},fail:function(e){console.log("fail:"+JSON.stringify(e))}}):e.showToast({title:u,icon:"none"});case 7:case"end":return n.stop()}}),n)})))()},changeNum:function(t){"add"==t?this.num++:1==this.num?e.showToast({title:"最少数量为1",icon:"none"}):this.num--},fenchData:function(){var t=this;return(0,c.default)(r.default.mark((function n(){var a,c,o,u;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,i.getCarParkPackageProductListById)({id:t.id});case 2:a=n.sent,c=a.data,o=a.code,u=a.message,console.log(c,o),10002==o?t.carParkInfo=c:e.showToast({title:u,icon:"none"});case 8:case"end":return n.stop()}}),n)})))()}}};t.default=o}).call(this,n("543d")["default"])},"38bd":function(e,t,n){"use strict";(function(e,t){var a=n("4ea4");n("c530");a(n("66fd"));var r=a(n("a07f"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(r.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},a07f:function(e,t,n){"use strict";n.r(t);var a=n("fece"),r=n("eb72");for(var c in r)["default"].indexOf(c)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(c);n("ffb3");var i=n("f0c5"),o=Object(i["a"])(r["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=o.exports},cc0e:function(e,t,n){},eb72:function(e,t,n){"use strict";n.r(t);var a=n("3111"),r=n.n(a);for(var c in a)["default"].indexOf(c)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(c);t["default"]=r.a},fece:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){}));var a=function(){var e=this.$createElement,t=(this._self._c,(this.carParkInfo.currentPrice*this.num).toFixed(2)),n=(this.carParkInfo.currentPrice*this.num).toFixed(2);this.$mp.data=Object.assign({},{$root:{g0:t,g1:n}})},r=[]},ffb3:function(e,t,n){"use strict";var a=n("cc0e"),r=n.n(a);r.a}},[["38bd","common/runtime","common/vendor"]]]);