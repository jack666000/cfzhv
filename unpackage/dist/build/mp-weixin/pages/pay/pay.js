(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/pay/pay"],{"174f":function(e,n,t){},3374:function(e,n,t){"use strict";t.r(n);var o=t("8de2"),a=t("8f4d");for(var r in a)["default"].indexOf(r)<0&&function(e){t.d(n,e,(function(){return a[e]}))}(r);t("bd11");var i=t("f0c5"),u=Object(i["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);n["default"]=u.exports},"8de2":function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return r})),t.d(n,"a",(function(){return o}));var o={uniPopup:function(){return t.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(t.bind(null,"1081"))}},a=function(){var e=this,n=e.$createElement,t=(e._self._c,e.getTimeDifference(e.order.inTime,e.order.outTime)),o=e._f("formatTimestamp")(e.order.inTime),a=e._f("formatTimestamp")(e.order.outTime),r=e.couponDetail.id?e.getcouponText():null,i=e.couponList.length;e.$mp.data=Object.assign({},{$root:{m0:t,f0:o,f1:a,m1:r,g0:i}})},r=[]},"8f4d":function(e,n,t){"use strict";t.r(n);var o=t("f38b"),a=t.n(o);for(var r in o)["default"].indexOf(r)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(r);n["default"]=a.a},bd11:function(e,n,t){"use strict";var o=t("174f"),a=t.n(o);a.a},f38b:function(e,n,t){"use strict";(function(e){var o=t("4ea4");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=o(t("2eee")),r=o(t("c973")),i=t("6d37"),u=t("a6a8"),c={data:function(){return{order:{carParkName:"",numberPlate:"",inTime:"",outTime:"",cfOrder:{amountsPayable:"",containCouponAmountsPayable:""},temporaryLicensePlate:!1},maskShow:!0,couponList:[],couponDetail:{id:""}}},filters:{formatTimestamp:u.formatTimestamp},onLoad:function(e){this.carParkUseLogId=e.carParkUseLogId,this.fenchData()},methods:{onPay:function(){var n=this;return(0,r.default)(a.default.mark((function t(){var o,r,u,c;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,i.payCarParkUseLogOrder)({carParkUseLogId:n.carParkUseLogId,couponId:n.couponDetail.id,paymentScenes:"wx_mp"});case 2:o=t.sent,r=o.data,u=o.code,c=o.message,10002===u?null==r?e.showToast({title:c,icon:"none"}):e.requestPayment({provider:"wxpay",timeStamp:r.timeStamp,nonceStr:r.nonceStr,package:r.package,signType:r.signType,paySign:r.paySign,success:function(n){"requestPayment:ok"==n.errMsg&&e.reLaunch({url:"/pages/pay/paymentComplete?price="+this.order.cfOrder.amountsPayable+"&parkName="+this.order.carParkName})},fail:function(n){e.showToast({title:n,icon:"none"}),console.log(n)}}):e.showToast({title:c,icon:"none"});case 7:case"end":return t.stop()}}),t)})))()},onAliPay:function(){var n=this;return(0,r.default)(a.default.mark((function t(){var o,r,u,c;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,i.payCarParkUseLogOrder)({carParkUseLogId:n.carParkUseLogId,couponId:"",paymentScenes:"ali_mp"});case 2:o=t.sent,r=o.data,u=o.code,c=o.message,10002===u?e.requestPayment({provider:"alipay",orderInfo:r.alipay_trade_create_response.trade_no,success:function(n){"9000"==n.resultCode?(e.showToast({title:"支付成功",icon:"none"}),setTimeout((function(){e.navigateBack()}),1500)):e.showToast({title:n.memo,icon:"none"})},fail:function(e){console.log("fail:"+JSON.stringify(e))}}):e.showToast({title:c,icon:"none"});case 7:case"end":return t.stop()}}),t)})))()},getcouponText:function(){var e=this.couponDetail,n=e.couponType,t=e.denomination,o=3===n?t/36e5:t,a="".concat(["次","元","小时"][n-1]," - ").concat(["次数券","金额券","时长券"][n-1]),r=o+" "+a;return r},onScrollCoupon:function(e){this.couponDetail=e,this.fenchData(),this.closeCouponPopup()},showCouponPopup:function(){this.couponList.length>0&&this.$refs.popup.open("bottom")},closeCouponPopup:function(){this.$refs.popup.close()},onNoCoupon:function(){this.couponDetail=null,this.closeCouponPopup()},getTimeDifference:function(e,n){return(0,u.timeDifference)(e,n)},fenchData:function(){var e=this;return(0,r.default)(a.default.mark((function n(){var t,o,r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,i.getCarParkUseLogOrder)({carParkUseLogId:e.carParkUseLogId,couponId:e.couponDetail.id});case 2:t=n.sent,o=t.data,r=t.code,10002===r&&(o.numberPlate.indexOf("临")>=0&&(o.temporaryLicensePlate=!0),e.order=o,null!=o.cfCouponList&&(e.couponList=o.cfCouponList,e.couponList.length>0&&(e.couponDetail=e.couponList[0])));case 6:case"end":return n.stop()}}),n)})))()}}};n.default=c}).call(this,t("543d")["default"])},f9ab:function(e,n,t){"use strict";(function(e,n){var o=t("4ea4");t("c530");o(t("66fd"));var a=o(t("3374"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(a.default)}).call(this,t("bc2e")["default"],t("543d")["createPage"])}},[["f9ab","common/runtime","common/vendor"]]]);