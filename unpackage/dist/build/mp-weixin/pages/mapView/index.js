(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mapView/index"],{"0988":function(t,e,n){},5033:function(t,e,n){"use strict";(function(t,e){var i=n("4ea4");n("c530");i(n("66fd"));var a=i(n("8f2b"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(a.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},5082:function(t,e,n){"use strict";(function(t,i){var a=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n("2eee")),o=a(n("c973")),c=n("6d37"),l=n("8981"),u=n("3d6f"),s=new u({key:l.qqmapKey}),d={data:function(){return{locationInfo:{longitude:"",latitude:""},longitude:"",latitude:"",insideParking:[],externalParking:[],parkMarkers:[],currently:{name:"",address:"",freeTime:0,parkingSpaceNumber:0,usedParkingSpaceNumber:0,currentPrice:0,distance:0},isInternal:!1,scale:14}},onLoad:function(){this.getLocation()},methods:{regionchange:function(t){if(console.log(t),"end"==t.type){var e=t.detail.centerLocation.latitude,n=t.detail.centerLocation.longitude;this.longitude=n,this.latitude=e,this.getCfParkLotList()}this.currently={}},controltap:function(e){var n=t.createMapContext("map");n.moveToLocation()},markertap:function(t){console.log(t);var e=t.detail.markerId;this.isInternal?this.currently=this.insideParking[e]:this.currently=this.externalParking[e]},intoParkingLotDetail:function(t){this.isInternal?i.navigateTo({url:"/pages/parkingLotDetail/parkingLotDetail?id="+this.currently.id}):i.openLocation({latitude:this.currently.location.lat,longitude:this.currently.location.lng,name:this.currently.title,address:this.currently.address})},distance:function(t){return t<1e3?t+"m ":t/1e3+"km "},getLocation:function(){var t=this;i.getLocation({type:"wgs84",success:function(e){console.log("当前位置的经度："+e.longitude),console.log("当前位置的纬度："+e.latitude),t.locationInfo.longitude=e.longitude,t.locationInfo.latitude=e.latitude,t.getCfParkLotList()}})},getCfParkLotList:function(){var t=this;return(0,o.default)(r.default.mark((function e(){var n,i,a;return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,c.cfCarParkGet)({positionX:t.longitude?t.longitude:t.locationInfo.longitude,positionY:t.latitude?t.latitude:t.locationInfo.latitude,distance:1e3,page:1,size:100});case 2:n=e.sent,i=n.data,a=n.code,console.log(i,a),10002==a?(t.isInternal=!0,t.insideParking=i,t.currently=i[0],t.refreshMarkers(i,"cf","park")):t.getOtherParkLot();case 7:case"end":return e.stop()}}),e)})))()},getOtherParkLot:function(){var t=this;s.search({keyword:"停车场",location:"".concat(this.latitude?this.latitude:this.locationInfo.latitude,",").concat(this.longitude?this.longitude:this.locationInfo.longitude),success:function(e){0===e.status&&(t.isInternal=!1,t.externalParking=e.data,t.currently=e.data[0],t.refreshMarkers(e.data,"tx","park"))},fail:function(t){console.log(t)}})},refreshMarkers:function(t,e,n){var i=[];"cf"===e?(t.forEach((function(t,e){i.push({id:e,latitude:t.positionY,longitude:t.positionX,title:t.name,iconPath:"http://file.cfeng.wang/parking_icon.png",width:"32",height:"32",callout:{content:t.name,color:"#FFFFFF",fontSize:12,bgColor:"#301819",padding:10,borderRadius:20}})})),"park"===n?this.parkMarkers=i:this.chargingMarkers=i):"tx"===e&&(t.forEach((function(t,e){i.push({id:e,latitude:t.location.lat,longitude:t.location.lng,title:t.title,iconPath:"http://file.cfeng.wang/parking_icon.png",width:"32",height:"32",callout:{content:t.title,color:"#FFFFFF",fontSize:12,bgColor:"#301819",padding:10,borderRadius:20}})})),"park"==n?this.parkMarkers=i:this.chargingMarkers=i)}}};e.default=d}).call(this,n("bc2e")["default"],n("543d")["default"])},"713c":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,n=(t._self._c,t.isInternal?(t.currently.freeTime/6e4).toFixed(0):null),i=t.isInternal?t.currently.currentPrice.toFixed(2):null,a=t.isInternal?(t.currently.distance/1e3).toFixed(2):null,r=t.isInternal?null:((t.currently._distance||0)/1e3).toFixed(2);t.$mp.data=Object.assign({},{$root:{g0:n,g1:i,g2:a,g3:r}})},a=[]},"71de":function(t,e,n){"use strict";var i=n("0988"),a=n.n(i);a.a},"8f2b":function(t,e,n){"use strict";n.r(e);var i=n("713c"),a=n("ae0f");for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);n("71de");var o=n("f0c5"),c=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);e["default"]=c.exports},ae0f:function(t,e,n){"use strict";n.r(e);var i=n("5082"),a=n.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);e["default"]=a.a}},[["5033","common/runtime","common/vendor"]]]);