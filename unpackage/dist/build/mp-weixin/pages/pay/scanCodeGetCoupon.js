(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/pay/scanCodeGetCoupon"],{"2ad7":function(n,e,t){"use strict";t.r(e);var o=t("7057"),a=t.n(o);for(var i in o)["default"].indexOf(i)<0&&function(n){t.d(e,n,(function(){return o[n]}))}(i);e["default"]=a.a},"56fd":function(n,e,t){"use strict";(function(n,e){var o=t("4ea4");t("c530");o(t("66fd"));var a=o(t("fd75"));n.__webpack_require_UNI_MP_PLUGIN__=t,e(a.default)}).call(this,t("bc2e")["default"],t("543d")["createPage"])},7057:function(n,e,t){"use strict";(function(n){var o=t("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(t("2eee")),i=o(t("c973")),c=t("6d37"),r=o(t("2d69")),u=null,d={components:{plateInput:function(){t.e("components/uni-plate-input/uni-plate-input").then(function(){return resolve(t("f049"))}.bind(null,t)).catch(t.oe)},wxmpLogin:function(){Promise.all([t.e("common/vendor"),t.e("components/wxmpLogin/wxmpLogin")]).then(function(){return resolve(t("a8b2"))}.bind(null,t)).catch(t.oe)},alimpLogin:function(){Promise.all([t.e("common/vendor"),t.e("components/alimpLogin/alimpLogin")]).then(function(){return resolve(t("fafa"))}.bind(null,t)).catch(t.oe)}},data:function(){return{codeId:"",randomCode:"",sTime:"",eTime:"",plateNo:"",couponDetail:{sourceType:0},plateShow:!1,isLogin:!1,status:0}},onLoad:function(e){var t=decodeURIComponent(e.q),o=this.extractCodeIdAndRandomCode(t);this.codeId=o.codeId,this.randomCode=o.randomCode,n.getStorageSync("token")?(this.isLogin=!0,this.getCouponInfo()):this.isLogin=!1,n.createInterstitialAd&&(u=n.createInterstitialAd({adUnitId:"adunit-940a0c9ec83f48e8"}),u.onLoad((function(){})),u.onError((function(n){})),u.onClose((function(){}))),u&&u.show().catch((function(n){console.error(n)}))},methods:{changeLoginStatus:function(n){n?(this.isLogin=!0,this.getCouponInfo()):this.isLogin=!1},setPlate:function(e){var t=this;e.length>=7&&(this.plateNo=e),this.plateShow=!1,n.showModal({title:"提示",content:"领取到".concat(e," 您确定吗？"),success:function(){var e=(0,i.default)(a.default.mark((function e(o){var i,r,u,d;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=o.confirm,!i){e.next=9;break}return e.next=4,(0,c.drawCouponByQrCode)({randomCode:t.randomCode,qrCodeId:t.codeId,targetObject:t.plateNo});case 4:r=e.sent,r.data,u=r.code,d=r.message,10002===u?(t.plateShow=!1,t.status=1,n.showToast({title:"领取成功",icon:"none"})):n.showToast({title:d,icon:"none"});case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()})},getCouponInfo:function(){var e=this;return(0,i.default)(a.default.mark((function t(){var o,i,r;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,c.getListByIdAnd)({randomCode:e.randomCode,id:e.codeId});case 2:o=t.sent,i=o.data,r=o.code,console.log(i),10002===r?(e.couponDetail=i,e.getCnTime()):n.showToast({title:"加载优惠券信息失败",icon:"none"});case 7:case"end":return t.stop()}}),t)})))()},getCnTime:function(){var n=Number(this.couponDetail.createTime),e=Number(this.couponDetail.expirationTime);this.sTime=(0,r.default)(n).format("YYYY-MM-DD"),this.eTime=(0,r.default)(e).format("YYYY-MM-DD")},extractCodeIdAndRandomCode:function(n){var e=n.match(/codeId\/(\d+)/),t=n.match(/RandomCode\/([^;/]+)/),o=e?e[1]:null,a=t?t[1]:null;return{codeId:o,randomCode:a}}}};e.default=d}).call(this,t("543d")["default"])},ceaf:function(n,e,t){"use strict";var o=t("f111"),a=t.n(o);a.a},f111:function(n,e,t){},f9e9:function(n,e,t){"use strict";t.d(e,"b",(function(){return a})),t.d(e,"c",(function(){return i})),t.d(e,"a",(function(){return o}));var o={wxmpLogin:function(){return Promise.all([t.e("common/vendor"),t.e("components/wxmpLogin/wxmpLogin")]).then(t.bind(null,"a8b2"))}},a=function(){var n=this,e=n.$createElement;n._self._c;n._isMounted||(n.e0=function(e){n.plateShow=!0},n.e1=function(e){n.plateShow=!1})},i=[]},fd75:function(n,e,t){"use strict";t.r(e);var o=t("f9e9"),a=t("2ad7");for(var i in a)["default"].indexOf(i)<0&&function(n){t.d(e,n,(function(){return a[n]}))}(i);t("ceaf");var c=t("f0c5"),r=Object(c["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);e["default"]=r.exports}},[["56fd","common/runtime","common/vendor"]]]);